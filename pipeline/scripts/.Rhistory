#geom_text(aes(label = word, y = if_else(cond_id == "Comma", 3000, 3500)), size = 2) +
#facet_grid(para_nr~cond_id) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("man", "and", "his", "wife", "ran", "away", "from", "the")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_coord_df = motr_df %>%
filter(experiment == "Coordination") %>%
# There's one item that has off indexing -- need to remove it
mutate(crit = if_else(word == "and", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(crit = if_else(item_id %in% c(45), crit + 1, crit + 2)) %>%
mutate(word_nr = word_nr - crit) #%>%
#mutate(zero = if_else(metric != "FPReg" & value == 0,T, F)) %>%
#filter(zero == F)
agg_motr_coord_df = motr_coord_df %>%
filter(word_nr >-5, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_coord_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_coord_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "comma", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition || subj) + (condition || item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_coord_stats_df = rbind(motr_coord_stats_df, result_df)
}
}
motr_coord_plotting_df = merge(agg_motr_coord_df, motr_coord_stats_df, all=T, by = c("word_nr", "metric"))
motr_coord_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = -0.5, xmax = 3.5, ymin = 300, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
#geom_text(aes(label = word, y = if_else(cond_id == "Comma", 3000, 3500)), size = 2) +
#facet_grid(para_nr~cond_id) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("man", "and", "his", "wife", "ran", "away", "from", "the")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_rc_df = motr_df %>%
filter(experiment == "Relative Clause") %>%
mutate(crit = if_else(word == "himself" | word == "herself", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(word_nr = word_nr - crit) %>%
mutate(zero = if_else(metric != "FPReg" & value == 0, T, F)) %>%
filter(zero == F)
agg_motr_rc_df = motr_rc_df %>%
filter(word_nr >= -4, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_rc_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_rc_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "high", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition || subj) + (condition || item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_rc_stats_df = rbind(motr_rc_stats_df, result_df)
}
}
motr_rc_plotting_df = merge(agg_motr_rc_df, motr_rc_stats_df, all=T, by = c("word_nr", "metric"))
motr_rc_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = 2.5, xmax = 5.5, ymin = 100, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
#geom_text(aes(label = word, y = if_else(cond_id == "Comma", 3000, 3500)), size = 2) +
#facet_grid(para_nr~cond_id) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("the", "fisherman", "who", "got", "himself\n herself", "a", "boat", "was")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_rc_df = motr_df %>%
filter(experiment == "Relative Clause") %>%
mutate(crit = if_else(word == "himself" | word == "herself", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(word_nr = word_nr - crit) #%>%
#mutate(zero = if_else(metric != "FPReg" & value == 0, T, F)) %>%
#filter(zero == F)
agg_motr_rc_df = motr_rc_df %>%
filter(word_nr >= -4, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_rc_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_rc_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "high", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition || subj) + (condition || item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_rc_stats_df = rbind(motr_rc_stats_df, result_df)
}
}
motr_rc_plotting_df = merge(agg_motr_rc_df, motr_rc_stats_df, all=T, by = c("word_nr", "metric"))
motr_rc_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = 2.5, xmax = 5.5, ymin = 100, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
#geom_text(aes(label = word, y = if_else(cond_id == "Comma", 3000, 3500)), size = 2) +
#facet_grid(para_nr~cond_id) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("the", "fisherman", "who", "got", "himself\n herself", "a", "boat", "was")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_adv_df = motr_df %>%
filter(experiment == "Adverb") %>%
mutate(crit = if_else(word == "last" | word == "next" | word == "yesterday" | word == "tomorrow", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(word_nr = word_nr - crit)#%>%
#mutate(zero = if_else(metric != "FPReg" & value == 0, T, F)) %>%
#filter(zero == F)
agg_motr_adv_df = motr_adv_df %>%
filter(word_nr >= -4, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_adv_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_rc_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "high", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition || subj) + (condition || item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_adv_stats_df = rbind(motr_adv_stats_df, result_df)
}
}
motr_adv_plotting_df = merge(agg_motr_adv_df, motr_adv_stats_df, all=T, by = c("word_nr", "metric"))
motr_adv_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = 2.5, xmax = 5.5, ymin = 100, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("the", "photos", "she", "took", "last/next", "week,", "but", "she")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_adv_df = motr_df %>%
filter(experiment == "Adverb") %>%
mutate(crit = if_else(word == "last" | word == "next" | word == "yesterday" | word == "tomorrow", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(word_nr = word_nr - crit)#%>%
#mutate(zero = if_else(metric != "FPReg" & value == 0, T, F)) %>%
#filter(zero == F)
agg_motr_adv_df = motr_adv_df %>%
filter(word_nr >= -4, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_adv_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_adv_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "high", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition || subj) + (condition || item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_adv_stats_df = rbind(motr_adv_stats_df, result_df)
}
}
motr_adv_plotting_df = merge(agg_motr_adv_df, motr_adv_stats_df, all=T, by = c("word_nr", "metric"))
motr_adv_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = 2.5, xmax = 5.5, ymin = 100, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("the", "photos", "she", "took", "last/next", "week,", "but", "she")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_adv_df = motr_df %>%
filter(experiment == "Adverb") %>%
mutate(crit = if_else(word == "last" | word == "next" | word == "yesterday" | word == "tomorrow", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(word_nr = word_nr - crit) %>%
mutate(zero = if_else(metric != "FPReg" & value == 0, T, F)) %>%
filter(zero == F)
agg_motr_adv_df = motr_adv_df %>%
filter(word_nr >= -4, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_adv_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_adv_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "high", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition || subj) + (condition || item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_adv_stats_df = rbind(motr_adv_stats_df, result_df)
}
}
motr_adv_plotting_df = merge(agg_motr_adv_df, motr_adv_stats_df, all=T, by = c("word_nr", "metric"))
motr_adv_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = 2.5, xmax = 5.5, ymin = 100, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("the", "photos", "she", "took", "last/next", "week,", "but", "she")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_rc_df = motr_df %>%
filter(experiment == "Relative Clause") %>%
mutate(crit = if_else(word == "himself" | word == "herself", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(word_nr = word_nr - crit) %>%
mutate(zero = if_else(metric != "FPReg" & value == 0, T, F)) %>%
filter(zero == F)
agg_motr_rc_df = motr_rc_df %>%
filter(word_nr >= -4, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_rc_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_rc_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "high", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition || subj) + (condition || item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_rc_stats_df = rbind(motr_rc_stats_df, result_df)
}
}
motr_rc_plotting_df = merge(agg_motr_rc_df, motr_rc_stats_df, all=T, by = c("word_nr", "metric"))
motr_rc_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = 2.5, xmax = 5.5, ymin = 100, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
#geom_text(aes(label = word, y = if_else(cond_id == "Comma", 3000, 3500)), size = 2) +
#facet_grid(para_nr~cond_id) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("the", "fisherman", "who", "got", "himself\n herself", "a", "boat", "was")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_rc_df = motr_df %>%
filter(experiment == "Relative Clause") %>%
mutate(crit = if_else(word == "himself" | word == "herself", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(word_nr = word_nr - crit) %>%
mutate(zero = if_else(metric != "FPReg" & value == 0, T, F)) %>%
filter(zero == F)
agg_motr_rc_df = motr_rc_df %>%
filter(word_nr >= -4, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_rc_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_rc_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "high", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition | subj) + (condition | item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_rc_stats_df = rbind(motr_rc_stats_df, result_df)
}
}
motr_rc_plotting_df = merge(agg_motr_rc_df, motr_rc_stats_df, all=T, by = c("word_nr", "metric"))
motr_rc_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = 2.5, xmax = 5.5, ymin = 100, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
#geom_text(aes(label = word, y = if_else(cond_id == "Comma", 3000, 3500)), size = 2) +
#facet_grid(para_nr~cond_id) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("the", "fisherman", "who", "got", "himself\n herself", "a", "boat", "was")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
motr_coord_df = motr_df %>%
filter(experiment == "Coordination") %>%
# There's one item that has off indexing -- need to remove it
mutate(crit = if_else(word == "and", word_nr, as.integer(0) )) %>%
group_by(condition, item_id) %>%
mutate(crit = unique(crit)[2]) %>%
ungroup() %>%
mutate(crit = if_else(item_id %in% c(45), crit + 1, crit + 2)) %>%
mutate(word_nr = word_nr - crit) %>%
mutate(zero = if_else(metric != "FPReg" & value == 0,T, F)) %>%
filter(zero == F)
agg_motr_coord_df = motr_coord_df %>%
filter(word_nr >-5, word_nr < 4) %>%
drop_na() %>%
group_by(condition, word_nr, metric) %>%
summarise( m = mean(value),
sd = std.error(value),
upper = m + 1.96 * sd,
lower = m - 1.98 * sd,
n = n()) %>%
ungroup()
motr_coord_stats_df = data.frame()
for(i in -3:3) {
for(m in c("first_duration", "gaze_duration", "go_past_time", "total_duration")){
temp_df = motr_coord_df %>% filter(metric == m) %>% filter(word_nr == i) %>%
mutate(item_id = as.factor(item_id), subj = as.factor(subj)) %>%
mutate(condition = if_else(condition == "comma", 1, 0)) %>%
mutate(value = scale(value))
model = lmer(value ~ condition + (condition || subj) + (condition || item_id), data = temp_df)
pval = coef(summary(model))[10]
estimate = coef(summary(model))[2]
result_df = data.frame(word_nr = i, metric = m, pval = pval, est = estimate)
motr_coord_stats_df = rbind(motr_coord_stats_df, result_df)
}
}
motr_coord_plotting_df = merge(agg_motr_coord_df, motr_coord_stats_df, all=T, by = c("word_nr", "metric"))
motr_coord_plotting_df %>%
mutate(sig = case_when( pval >= 0.05 ~ " ",
pval < 0.05 & pval >= 0.01  ~ "*",
pval < 0.01 & pval >= 0.001  ~ "**",
pval < 0.001  ~ "***")) %>%
ggplot(aes(x = word_nr, y = m, color = condition)) +
#geom_rect(aes(xmin = -0.5, xmax = 3.5, ymin = 300, ymax = 800), fill=alpha("white", 0), color = "#45ef70", linetype = "dotted") +
geom_point() +
geom_errorbar(aes(ymax = upper, ymin = lower), width = 0.3) +
geom_line() +
geom_text(aes(label = sig, y = if_else(metric=="FPReg", 0, 700)), color = "black") +
geom_text(aes(label = " ", y = if_else(metric=="FPReg", 0, 750))) +
#geom_text(aes(label = word, y = if_else(cond_id == "Comma", 3000, 3500)), size = 2) +
#facet_grid(para_nr~cond_id) +
ylab("Reading Time") +
xlab("Condition") +
scale_x_continuous(breaks=-4:3, labels=c("man", "and", "his", "wife", "ran", "away", "from", "the")) +
facet_wrap(.~metric, scales="free_y") +
theme(
legend.position = "bottom",
axis.text.x = element_text(angle = 45, hjust = 1)
)
