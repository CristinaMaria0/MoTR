shhh(library(tidyverse))
shhh(library(boot))
shhh(library(rsample))
shhh(library(plotrix))
shhh(library(ggrepel))
shhh(library(mgcv))
# `theme_set(theme_bw())` is a command in R that sets the default theme for all subsequent plots to a theme called `theme_bw()`.
# `theme_bw()` is a built-in theme in the ggplot2 package that provides a classic black-and-white theme with white grid lines. By setting the default theme to `theme_bw()`, all plots that are created using ggplot2 will have this theme unless a different theme is explicitly specified.
theme_set(theme_bw())
# `options(digits=4)` is a command in R that sets the number of digits to display when printing numeric values.
# By default, R will print up to 7 digits for numeric values. However, you can use the `options()` function to change this behavior. In this case, `options(digits=4)` sets the number of digits to 4, which means that all numeric values will be displayed with at most 4 digits.
options(digits=4)
set.seed(444)
# The `pipe_message` function first outputs the status message using the message() function. This can be useful for tracking the progress of a long computation or for providing information to the user.
# After printing the message, the function returns the .data argument unchanged. This allows the function to be used as a "pipe" in a data processing pipeline, where the output of one function is used as the input to the next function.
pipe_message = function(.data, status) {message(status); .data}
# Interesting way of reading multiple files in one directory!
file_prefix = "../reading_measures/cleaned_f160/provo/"
fnames = list.files(path=file_prefix)
# fnames: [1] "reader_55_reading_measures.csv" "reader_56_reading_measures.csv"
# [3] "reader_59_reading_measures.csv" "reader_61_reading_measures.csv"
# Read in the data
df = data.frame()
# uses the mutate() function from the dplyr package to create a new column in a data frame called subj. The new column is created by removing the substring _reading_measures.csv from the values in an existing column called f.
for (f in fnames) {
temp = read.csv(paste0(file_prefix, "/", f)) %>%
mutate(subj = str_remove(f, "_reading_measures.csv")) %>%
dplyr::select(expr_id, cond_id, para_nr, word, word_nr, first_duration, total_duration,
gaze_duration, go_pass_time, FPReg, subj) %>%
rename(go_past_time = go_pass_time)
df = rbind(df, temp)
}
df
# `gather will take column 6-9's column name make it rows, name 'metric', take their value as another row`
motr_df = df %>%
mutate(expr_id = if_else(expr_id == 1, "Attachment", "Provo")) %>%
gather(metric, value, 6:10)
motr_df
# Average across subjects
motr_agg_df = motr_df %>%
drop_na() %>%
group_by(expr_id, cond_id, para_nr, word, word_nr, metric) %>%
summarise(value = mean(value)) %>%    # sum up four subjects for each metric and divide by 4.
ungroup() %>%
arrange(expr_id, cond_id, para_nr, word_nr)   # like sort in python
# View(motr_agg_df)
motr_agg_df
table(motr_df$subj)
# reader_55 reader_56 reader_59 reader_61
#    3100      3100      3100      3100
motr_provo_df = motr_agg_df %>%
filter(expr_id == "Provo") %>%
rename(text_id = para_nr,
word_text_idx = word_nr,
motr_value = value) %>%
filter(motr_value != 0.0) %>%
dplyr::select(-expr_id, -cond_id)
motr_provo_df
# `suppressPackageStartupMessages` is a function in R that suppresses the startup messages that are generated when loading a package. It can be useful to prevent the console from being cluttered with messages when you are loading multiple packages or when you don't want to see the package loading messages.
shhh <- suppressPackageStartupMessages # It's a library, so shhh!
shhh(library( mgcv ))
shhh(library(dplyr))
shhh(library(ggplot2))
shhh(library(lme4))
shhh(library(tidymv))
shhh(library(gamlss))
shhh(library(gsubfn))
shhh(library(lmerTest))
shhh(library(tidyverse))
shhh(library(boot))
shhh(library(rsample))
shhh(library(plotrix))
shhh(library(ggrepel))
shhh(library(mgcv))
# `theme_set(theme_bw())` is a command in R that sets the default theme for all subsequent plots to a theme called `theme_bw()`.
# `theme_bw()` is a built-in theme in the ggplot2 package that provides a classic black-and-white theme with white grid lines. By setting the default theme to `theme_bw()`, all plots that are created using ggplot2 will have this theme unless a different theme is explicitly specified.
theme_set(theme_bw())
# `options(digits=4)` is a command in R that sets the number of digits to display when printing numeric values.
# By default, R will print up to 7 digits for numeric values. However, you can use the `options()` function to change this behavior. In this case, `options(digits=4)` sets the number of digits to 4, which means that all numeric values will be displayed with at most 4 digits.
options(digits=4)
set.seed(444)
# The `pipe_message` function first outputs the status message using the message() function. This can be useful for tracking the progress of a long computation or for providing information to the user.
# After printing the message, the function returns the .data argument unchanged. This allows the function to be used as a "pipe" in a data processing pipeline, where the output of one function is used as the input to the next function.
pipe_message = function(.data, status) {message(status); .data}
# Interesting way of reading multiple files in one directory!
file_prefix = "../reading_measures/cleaned_f160/provo/"
fnames = list.files(path=file_prefix)
# fnames: [1] "reader_55_reading_measures.csv" "reader_56_reading_measures.csv"
# [3] "reader_59_reading_measures.csv" "reader_61_reading_measures.csv"
# Read in the data
df = data.frame()
# uses the mutate() function from the dplyr package to create a new column in a data frame called subj. The new column is created by removing the substring _reading_measures.csv from the values in an existing column called f.
for (f in fnames) {
temp = read.csv(paste0(file_prefix, "/", f)) %>%
mutate(subj = str_remove(f, "_reading_measures.csv")) %>%
dplyr::select(expr_id, cond_id, para_nr, word, word_nr, first_duration, total_duration,
gaze_duration, go_pass_time, FPReg, subj) %>%
rename(go_past_time = go_pass_time)
df = rbind(df, temp)
}
df
# `gather will take column 6-9's column name make it rows, name 'metric', take their value as another row`
motr_df = df %>%
mutate(expr_id = if_else(expr_id == 1, "Attachment", "Provo")) %>%
gather(metric, value, 6:10)
motr_df
# Average across subjects
motr_agg_df = motr_df %>%
drop_na() %>%
group_by(expr_id, cond_id, para_nr, word, word_nr, metric) %>%
summarise(value = mean(value)) %>%    # sum up four subjects for each metric and divide by 4.
ungroup() %>%
arrange(expr_id, cond_id, para_nr, word_nr)   # like sort in python
# View(motr_agg_df)
motr_agg_df
table(motr_df$subj)
# reader_55 reader_56 reader_59 reader_61
#    3100      3100      3100      3100
motr_provo_df = motr_agg_df %>%
filter(expr_id == "Provo") %>%
rename(text_id = para_nr,
word_text_idx = word_nr,
motr_value = value) %>%
filter(motr_value != 0.0) %>%
dplyr::select(-expr_id, -cond_id)
motr_provo_df
# Read in Provo surprisal, frequency and length data
provo_modeling_df = read.csv("../ancillary_data/provo_df.csv") %>%
dplyr::select(text_id, sent_id, trigger_idx, word, freq, surp, len) %>%
rename(word_idx = trigger_idx)
provo_modeling_df
# Read in Provo eyetracking data
provo_raw_df = read.csv("../ancillary_data/provo_eyetracking.csv")
provo_eyetracking_df = provo_raw_df %>%
dplyr::select(Participant_ID, Text_ID, Sentence_Number, Word_In_Sentence_Number, IA_ID, Word,IA_FIRST_FIXATION_DURATION, IA_FIRST_FIX_PROGRESSIVE, IA_FIRST_RUN_DWELL_TIME, IA_DWELL_TIME, IA_REGRESSION_PATH_DURATION, IA_REGRESSION_OUT) %>%
rename( first_duration = IA_FIRST_FIXATION_DURATION,    # whether it is first pass?
gaze_duration = IA_FIRST_RUN_DWELL_TIME,
total_duration = IA_DWELL_TIME,
go_past_time = IA_REGRESSION_PATH_DURATION,
FPReg = IA_REGRESSION_OUT,
subj = Participant_ID,
text_id = Text_ID,
sent_id = Sentence_Number,
word_idx = Word_In_Sentence_Number,
word_text_idx = IA_ID,
word = Word,
ff_progressive = IA_FIRST_FIX_PROGRESSIVE) %>% # notice:average across subj, binary(0,1) becomes float.
mutate(gaze_duration = ifelse(ff_progressive == 0, 0, gaze_duration),
go_past_time = ifelse(ff_progressive == 0, 0, go_past_time)) %>%
dplyr::select(-ff_progressive) %>%
gather(metric, value, 7:11) %>%      # not include FFReg which is in column 11
# mutate(value = if_else(is.na(value), as.integer(0), as.integer(value))) %>%
drop_na() %>%   # actually, drop first word in a sentence
group_by(text_id, word_text_idx, sent_id, word_idx, word, metric) %>%
summarise(value = mean(value)) %>%
ungroup()
# View(provo_eyetracking_df)
provo_eyetracking_df
provo_df = merge(provo_eyetracking_df, provo_modeling_df, by=c("text_id", "sent_id", "word_idx")) %>%
mutate(word_text_idx = as.integer(word_text_idx - 1)) %>%
arrange(text_id, sent_id, word_idx)
provo_df
provo_df = merge(provo_df, motr_provo_df, by=c("text_id", "word_text_idx", "metric")) %>%
rename(eyetr_value = value) %>%
arrange(text_id, sent_id, word_idx) %>%
filter(word.x == word) %>%      #word.y has no captical word
dplyr::select(-word.x, -word.y) %>%
mutate(motr_outlier = if_else(motr_value > (mean(motr_value) + 3 * sd(motr_value) ), T, F)) %>%
filter(motr_outlier == F) %>%     # clear outlier -> 13 was filtered.
gather(measure, value, c("eyetr_value", "motr_value"))  %>%
# filter(metric != "first_duration") %>%
filter(metric != "FPReg")
View(provo_df)
provo_df %>%
ggplot(aes(x = value, color=metric)) +
geom_density() +
facet_wrap(.~measure) +
xlab("Reading Measure")
# ggsave("../visualization/density.png", device = "png", width = 6, height = 2.5)
provo_df %>%
filter(measure == "motr_value") %>%
ggplot(aes(x = value, color=metric)) +
geom_density() +
xlab("Reading Measure") +
ggtitle("Density plot of value for motr")
# `suppressPackageStartupMessages` is a function in R that suppresses the startup messages that are generated when loading a package. It can be useful to prevent the console from being cluttered with messages when you are loading multiple packages or when you don't want to see the package loading messages.
shhh <- suppressPackageStartupMessages # It's a library, so shhh!
shhh(library( mgcv ))
shhh(library(dplyr))
shhh(library(ggplot2))
shhh(library(lme4))
shhh(library(tidymv))
shhh(library(gamlss))
shhh(library(gsubfn))
shhh(library(lmerTest))
shhh(library(tidyverse))
shhh(library(boot))
shhh(library(rsample))
shhh(library(plotrix))
shhh(library(ggrepel))
shhh(library(mgcv))
# `theme_set(theme_bw())` is a command in R that sets the default theme for all subsequent plots to a theme called `theme_bw()`.
# `theme_bw()` is a built-in theme in the ggplot2 package that provides a classic black-and-white theme with white grid lines. By setting the default theme to `theme_bw()`, all plots that are created using ggplot2 will have this theme unless a different theme is explicitly specified.
theme_set(theme_bw())
# `options(digits=4)` is a command in R that sets the number of digits to display when printing numeric values.
# By default, R will print up to 7 digits for numeric values. However, you can use the `options()` function to change this behavior. In this case, `options(digits=4)` sets the number of digits to 4, which means that all numeric values will be displayed with at most 4 digits.
options(digits=4)
set.seed(444)
# The `pipe_message` function first outputs the status message using the message() function. This can be useful for tracking the progress of a long computation or for providing information to the user.
# After printing the message, the function returns the .data argument unchanged. This allows the function to be used as a "pipe" in a data processing pipeline, where the output of one function is used as the input to the next function.
pipe_message = function(.data, status) {message(status); .data}
# Interesting way of reading multiple files in one directory!
file_prefix = "../reading_measures/cleaned_f160/provo/"
fnames = list.files(path=file_prefix)
# fnames: [1] "reader_55_reading_measures.csv" "reader_56_reading_measures.csv"
# [3] "reader_59_reading_measures.csv" "reader_61_reading_measures.csv"
# Read in the data
df = data.frame()
# uses the mutate() function from the dplyr package to create a new column in a data frame called subj. The new column is created by removing the substring _reading_measures.csv from the values in an existing column called f.
for (f in fnames) {
temp = read.csv(paste0(file_prefix, "/", f)) %>%
mutate(subj = str_remove(f, "_reading_measures.csv")) %>%
dplyr::select(expr_id, cond_id, para_nr, word, word_nr, first_duration, total_duration,
gaze_duration, go_pass_time, FPReg, subj) %>%
rename(go_past_time = go_pass_time)
df = rbind(df, temp)
}
df
# `gather will take column 6-9's column name make it rows, name 'metric', take their value as another row`
motr_df = df %>%
mutate(expr_id = if_else(expr_id == 1, "Attachment", "Provo")) %>%
gather(metric, value, 6:10)
motr_df
# Average across subjects
motr_agg_df = motr_df %>%
drop_na() %>%
group_by(expr_id, cond_id, para_nr, word, word_nr, metric) %>%
summarise(value = mean(value)) %>%    # sum up four subjects for each metric and divide by 4.
ungroup() %>%
arrange(expr_id, cond_id, para_nr, word_nr)   # like sort in python
# View(motr_agg_df)
motr_agg_df
table(motr_df$subj)
# reader_55 reader_56 reader_59 reader_61
#    3100      3100      3100      3100
# `suppressPackageStartupMessages` is a function in R that suppresses the startup messages that are generated when loading a package. It can be useful to prevent the console from being cluttered with messages when you are loading multiple packages or when you don't want to see the package loading messages.
shhh <- suppressPackageStartupMessages # It's a library, so shhh!
shhh(library( mgcv ))
shhh(library(dplyr))
shhh(library(ggplot2))
shhh(library(lme4))
shhh(library(tidymv))
shhh(library(gamlss))
shhh(library(gsubfn))
shhh(library(lmerTest))
shhh(library(tidyverse))
shhh(library(boot))
shhh(library(rsample))
shhh(library(plotrix))
shhh(library(ggrepel))
shhh(library(mgcv))
# `theme_set(theme_bw())` is a command in R that sets the default theme for all subsequent plots to a theme called `theme_bw()`.
# `theme_bw()` is a built-in theme in the ggplot2 package that provides a classic black-and-white theme with white grid lines. By setting the default theme to `theme_bw()`, all plots that are created using ggplot2 will have this theme unless a different theme is explicitly specified.
theme_set(theme_bw())
# `options(digits=4)` is a command in R that sets the number of digits to display when printing numeric values.
# By default, R will print up to 7 digits for numeric values. However, you can use the `options()` function to change this behavior. In this case, `options(digits=4)` sets the number of digits to 4, which means that all numeric values will be displayed with at most 4 digits.
options(digits=4)
set.seed(444)
# The `pipe_message` function first outputs the status message using the message() function. This can be useful for tracking the progress of a long computation or for providing information to the user.
# After printing the message, the function returns the .data argument unchanged. This allows the function to be used as a "pipe" in a data processing pipeline, where the output of one function is used as the input to the next function.
pipe_message = function(.data, status) {message(status); .data}
# Interesting way of reading multiple files in one directory!
file_prefix = "../reading_measures/cleaned_f160/provo/"
fnames = list.files(path=file_prefix)
# fnames: [1] "reader_55_reading_measures.csv" "reader_56_reading_measures.csv"
# [3] "reader_59_reading_measures.csv" "reader_61_reading_measures.csv"
# Read in the data
df = data.frame()
# uses the mutate() function from the dplyr package to create a new column in a data frame called subj. The new column is created by removing the substring _reading_measures.csv from the values in an existing column called f.
for (f in fnames) {
temp = read.csv(paste0(file_prefix, "/", f)) %>%
mutate(subj = str_remove(f, "_reading_measures.csv")) %>%
dplyr::select(expr_id, cond_id, para_nr, word, word_nr, first_duration, total_duration,
gaze_duration, go_pass_time, FPReg, subj) %>%
rename(go_past_time = go_pass_time)
df = rbind(df, temp)
}
df
# `gather will take column 6-9's column name make it rows, name 'metric', take their value as another row`
motr_df = df %>%
mutate(expr_id = if_else(expr_id == 1, "Attachment", "Provo")) %>%
gather(metric, value, 6:10)
motr_df
# Average across subjects
motr_agg_df = motr_df %>%
drop_na() %>%
group_by(expr_id, cond_id, para_nr, word, word_nr, metric) %>%
summarise(value = mean(value)) %>%    # sum up four subjects for each metric and divide by 4.
ungroup() %>%
arrange(expr_id, cond_id, para_nr, word_nr)   # like sort in python
# View(motr_agg_df)
motr_agg_df
table(motr_df$subj)
# reader_55 reader_56 reader_59 reader_61
#    3100      3100      3100      3100
motr_provo_df = motr_agg_df %>%
filter(expr_id == "Provo") %>%
rename(text_id = para_nr,
word_text_idx = word_nr,
motr_value = value) %>%
filter(motr_value != 0.0) %>%
dplyr::select(-expr_id, -cond_id)
motr_provo_df
# Read in Provo surprisal, frequency and length data
provo_modeling_df = read.csv("../ancillary_data/provo_df.csv") %>%
dplyr::select(text_id, sent_id, trigger_idx, word, freq, surp, len) %>%
rename(word_idx = trigger_idx)
provo_modeling_df
# `suppressPackageStartupMessages` is a function in R that suppresses the startup messages that are generated when loading a package. It can be useful to prevent the console from being cluttered with messages when you are loading multiple packages or when you don't want to see the package loading messages.
shhh <- suppressPackageStartupMessages # It's a library, so shhh!
shhh(library( mgcv ))
shhh(library(dplyr))
shhh(library(ggplot2))
shhh(library(lme4))
shhh(library(tidymv))
shhh(library(gamlss))
shhh(library(gsubfn))
shhh(library(lmerTest))
shhh(library(tidyverse))
shhh(library(boot))
shhh(library(rsample))
shhh(library(plotrix))
shhh(library(ggrepel))
shhh(library(mgcv))
# `theme_set(theme_bw())` is a command in R that sets the default theme for all subsequent plots to a theme called `theme_bw()`.
# `theme_bw()` is a built-in theme in the ggplot2 package that provides a classic black-and-white theme with white grid lines. By setting the default theme to `theme_bw()`, all plots that are created using ggplot2 will have this theme unless a different theme is explicitly specified.
theme_set(theme_bw())
# `options(digits=4)` is a command in R that sets the number of digits to display when printing numeric values.
# By default, R will print up to 7 digits for numeric values. However, you can use the `options()` function to change this behavior. In this case, `options(digits=4)` sets the number of digits to 4, which means that all numeric values will be displayed with at most 4 digits.
options(digits=4)
set.seed(444)
# The `pipe_message` function first outputs the status message using the message() function. This can be useful for tracking the progress of a long computation or for providing information to the user.
# After printing the message, the function returns the .data argument unchanged. This allows the function to be used as a "pipe" in a data processing pipeline, where the output of one function is used as the input to the next function.
pipe_message = function(.data, status) {message(status); .data}
# Interesting way of reading multiple files in one directory!
file_prefix = "../reading_measures/cleaned_f160/provo/"
fnames = list.files(path=file_prefix)
# fnames: [1] "reader_55_reading_measures.csv" "reader_56_reading_measures.csv"
# [3] "reader_59_reading_measures.csv" "reader_61_reading_measures.csv"
# Read in the data
df = data.frame()
# uses the mutate() function from the dplyr package to create a new column in a data frame called subj. The new column is created by removing the substring _reading_measures.csv from the values in an existing column called f.
for (f in fnames) {
temp = read.csv(paste0(file_prefix, "/", f)) %>%
mutate(subj = str_remove(f, "_reading_measures.csv")) %>%
dplyr::select(expr_id, cond_id, para_nr, word, word_nr, first_duration, total_duration,
gaze_duration, go_pass_time, FPReg, subj) %>%
rename(go_past_time = go_pass_time)
df = rbind(df, temp)
}
df
# `gather will take column 6-9's column name make it rows, name 'metric', take their value as another row`
motr_df = df %>%
mutate(expr_id = if_else(expr_id == 1, "Attachment", "Provo")) %>%
gather(metric, value, 6:10)
motr_df
# Average across subjects
motr_agg_df = motr_df %>%
drop_na() %>%
group_by(expr_id, cond_id, para_nr, word, word_nr, metric) %>%
summarise(value = mean(value)) %>%    # sum up four subjects for each metric and divide by 4.
ungroup() %>%
arrange(expr_id, cond_id, para_nr, word_nr)   # like sort in python
# View(motr_agg_df)
motr_agg_df
table(motr_df$subj)
# reader_55 reader_56 reader_59 reader_61
#    3100      3100      3100      3100
motr_provo_df = motr_agg_df %>%
filter(expr_id == "Provo") %>%
rename(text_id = para_nr,
word_text_idx = word_nr,
motr_value = value) %>%
filter(motr_value != 0.0) %>%
dplyr::select(-expr_id, -cond_id)
motr_provo_df
# Read in Provo surprisal, frequency and length data
provo_modeling_df = read.csv("../ancillary_data/provo_df.csv") %>%
dplyr::select(text_id, sent_id, trigger_idx, word, freq, surp, len) %>%
rename(word_idx = trigger_idx)
provo_modeling_df
# `suppressPackageStartupMessages` is a function in R that suppresses the startup messages that are generated when loading a package. It can be useful to prevent the console from being cluttered with messages when you are loading multiple packages or when you don't want to see the package loading messages.
shhh <- suppressPackageStartupMessages # It's a library, so shhh!
shhh(library( mgcv ))
shhh(library(dplyr))
shhh(library(ggplot2))
shhh(library(lme4))
shhh(library(tidymv))
shhh(library(gamlss))
shhh(library(gsubfn))
shhh(library(lmerTest))
shhh(library(tidyverse))
shhh(library(boot))
shhh(library(rsample))
shhh(library(plotrix))
shhh(library(ggrepel))
shhh(library(mgcv))
# `theme_set(theme_bw())` is a command in R that sets the default theme for all subsequent plots to a theme called `theme_bw()`.
# `theme_bw()` is a built-in theme in the ggplot2 package that provides a classic black-and-white theme with white grid lines. By setting the default theme to `theme_bw()`, all plots that are created using ggplot2 will have this theme unless a different theme is explicitly specified.
theme_set(theme_bw())
# `options(digits=4)` is a command in R that sets the number of digits to display when printing numeric values.
# By default, R will print up to 7 digits for numeric values. However, you can use the `options()` function to change this behavior. In this case, `options(digits=4)` sets the number of digits to 4, which means that all numeric values will be displayed with at most 4 digits.
options(digits=4)
set.seed(444)
# The `pipe_message` function first outputs the status message using the message() function. This can be useful for tracking the progress of a long computation or for providing information to the user.
# After printing the message, the function returns the .data argument unchanged. This allows the function to be used as a "pipe" in a data processing pipeline, where the output of one function is used as the input to the next function.
pipe_message = function(.data, status) {message(status); .data}
# Interesting way of reading multiple files in one directory!
file_prefix = "../reading_measures/cleaned_f160/provo/"
fnames = list.files(path=file_prefix)
# fnames: [1] "reader_55_reading_measures.csv" "reader_56_reading_measures.csv"
# [3] "reader_59_reading_measures.csv" "reader_61_reading_measures.csv"
# Read in the data
df = data.frame()
# uses the mutate() function from the dplyr package to create a new column in a data frame called subj. The new column is created by removing the substring _reading_measures.csv from the values in an existing column called f.
for (f in fnames) {
temp = read.csv(paste0(file_prefix, "/", f)) %>%
mutate(subj = str_remove(f, "_reading_measures.csv")) %>%
dplyr::select(expr_id, cond_id, para_nr, word, word_nr, first_duration, total_duration,
gaze_duration, go_pass_time, FPReg, subj) %>%
rename(go_past_time = go_pass_time)
df = rbind(df, temp)
}
df
# `gather will take column 6-9's column name make it rows, name 'metric', take their value as another row`
motr_df = df %>%
mutate(expr_id = if_else(expr_id == 1, "Attachment", "Provo")) %>%
gather(metric, value, 6:10)
motr_df
# Average across subjects
motr_agg_df = motr_df %>%
drop_na() %>%
group_by(expr_id, cond_id, para_nr, word, word_nr, metric) %>%
summarise(value = mean(value)) %>%    # sum up four subjects for each metric and divide by 4.
ungroup() %>%
arrange(expr_id, cond_id, para_nr, word_nr)   # like sort in python
# View(motr_agg_df)
motr_agg_df
table(motr_df$subj)
# reader_55 reader_56 reader_59 reader_61
#    3100      3100      3100      3100
motr_provo_df = motr_agg_df %>%
filter(expr_id == "Provo") %>%
rename(text_id = para_nr,
word_text_idx = word_nr,
motr_value = value) %>%
filter(motr_value != 0.0) %>%
dplyr::select(-expr_id, -cond_id)
motr_provo_df
# Read in Provo surprisal, frequency and length data
provo_modeling_df = read.csv("../ancillary_data/provo_df.csv") %>%
dplyr::select(text_id, sent_id, trigger_idx, word, freq, surp, len) %>%
rename(word_idx = trigger_idx)
provo_modeling_df
# Read in Provo eyetracking data
provo_raw_df = read.csv("../ancillary_data/provo_eyetracking.csv")
provo_eyetracking_df = provo_raw_df %>%
dplyr::select(Participant_ID, Text_ID, Sentence_Number, Word_In_Sentence_Number, IA_ID, Word,IA_FIRST_FIXATION_DURATION, IA_FIRST_FIX_PROGRESSIVE, IA_FIRST_RUN_DWELL_TIME, IA_DWELL_TIME, IA_REGRESSION_PATH_DURATION, IA_REGRESSION_OUT) %>%
rename( first_duration = IA_FIRST_FIXATION_DURATION,    # whether it is first pass?
gaze_duration = IA_FIRST_RUN_DWELL_TIME,
total_duration = IA_DWELL_TIME,
go_past_time = IA_REGRESSION_PATH_DURATION,
FPReg = IA_REGRESSION_OUT,
subj = Participant_ID,
text_id = Text_ID,
sent_id = Sentence_Number,
word_idx = Word_In_Sentence_Number,
word_text_idx = IA_ID,
word = Word,
ff_progressive = IA_FIRST_FIX_PROGRESSIVE) %>% # notice:average across subj, binary(0,1) becomes float.
mutate(gaze_duration = ifelse(ff_progressive == 0, 0, gaze_duration),
go_past_time = ifelse(ff_progressive == 0, 0, go_past_time)) %>%
dplyr::select(-ff_progressive) %>%
gather(metric, value, 7:11) %>%      # not include FFReg which is in column 11
mutate(value = if_else(is.na(value), as.integer(0), as.integer(value))) %>%
drop_na() %>%   # actually, drop first word in a sentence
group_by(text_id, word_text_idx, sent_id, word_idx, word, metric) %>%
summarise(value = mean(value)) %>%
ungroup()
# View(provo_eyetracking_df)
provo_eyetracking_df
provo_df = merge(provo_eyetracking_df, provo_modeling_df, by=c("text_id", "sent_id", "word_idx")) %>%
mutate(word_text_idx = as.integer(word_text_idx - 1)) %>%
arrange(text_id, sent_id, word_idx)
provo_df
provo_df = merge(provo_df, motr_provo_df, by=c("text_id", "word_text_idx", "metric")) %>%
rename(eyetr_value = value) %>%
arrange(text_id, sent_id, word_idx) %>%
filter(word.x == word) %>%      #word.y has no captical word
dplyr::select(-word.x, -word.y) %>%
mutate(motr_outlier = if_else(motr_value > (mean(motr_value) + 3 * sd(motr_value) ), T, F)) %>%
filter(motr_outlier == F) %>%     # clear outlier -> 13 was filtered.
gather(measure, value, c("eyetr_value", "motr_value"))  %>%
# filter(metric != "first_duration") %>%
filter(metric != "FPReg")
View(provo_df)
provo_df %>%
ggplot(aes(x = value, color=metric)) +
geom_density() +
facet_wrap(.~measure) +
xlab("Reading Measure")
# ggsave("../visualization/density.png", device = "png", width = 6, height = 2.5)
